function readin()
cd '/Users/penn/Documents/Data/fianl_project';
filename='/Users/penn/Documents/Data/monthly_P_T/Climate Research Unit/cru_ts3.23.1901.2014.pre.dat.nc';
lon=ncread(filename,'lon');
lat=ncread(filename,'lat');
T=1368;
result_np=NaN(length(lon),length(lat),4,T);
result_p=NaN(length(lon),length(lat),4,T);
scales=[1,3,6,12];
s_repeat=1;
s_real=1;
for i=1:length(lon)
    for j=1:length(lat)
        x=squeeze(ncread(filename,'pre',[i,j,1],[1,1,24]));
        if not(isnan(x))&&isequal(x(1:12),x(13:24))
            fakeposition(s_repeat,:)=[i,j];
            s_repeat=s_repeat+1;
        elseif not(isnan(x))
            realposition(s_real,:)=[i,j];
            pre=squeeze(ncread(filename,'pre',[i,j,1],[1,1,inf]));
            for k=1:4
                %aggregate
                pre_a=aggregate(pre,scales(k));
                %calculate
                result_np(i,j,k,1:T-scales(k)+1)=SPI_np(pre_a,scales(k));
                result_p(i,j,k,1:T-scales(k)+1)=SPI_p(pre_a,scales(k));
                disp([i,j,k]);
            end
        end
    end
end
end